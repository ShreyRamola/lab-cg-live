<!DOCTYPE html>
<html>
<head>
<title>3D Projection Visualizer</title>
<style>
    body {
        background: #111;
        color: #fff;
        font-family: Arial;
        text-align: center;
        margin: 0;
        overflow: hidden;
    }
    canvas {
        background: #000;
        border: 1px solid #444;
        display: block;
        margin: auto;
        margin-top: 10px;
    }
</style>
</head>
<body>

<h2>3D Projection Visualizer</h2>
<p>
1â€“4 Shape | Arrow Keys Rotate | A/D Z-Rotate | +/- Zoom  
| O Ortho | P Perspective | I Isometric | M Multi-mode
</p>

<canvas id="canvas" width="800" height="600"></canvas>

<script>
// ------------------- SETUP --------------------
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let angleX = 0, angleY = 0, angleZ = 0;
let zoom = 1;
let choice = 1;
let multiMode = false;

let projection = "perspective";

// 3D Point
class Point3D {
    constructor(x, y, z) {
        this.x = x; this.y = y; this.z = z;
    }
}

// ------------------- ROTATION --------------------
function rotatePoint(p) {
    let x = p.x, y = p.y, z = p.z;

    let radX = angleX * Math.PI / 180;
    let radY = angleY * Math.PI / 180;
    let radZ = angleZ * Math.PI / 180;

    // Z rotation
    let x1 = x * Math.cos(radZ) - y * Math.sin(radZ);
    let y1 = x * Math.sin(radZ) + y * Math.cos(radZ);

    x = x1; y = y1;

    // Y rotation
    let x2 = x * Math.cos(radY) + z * Math.sin(radY);
    let z2 = -x * Math.sin(radY) + z * Math.cos(radY);

    x = x2; z = z2;

    // X rotation
    let y2 = y * Math.cos(radX) - z * Math.sin(radX);
    let z3 = y * Math.sin(radX) + z * Math.cos(radX);

    return new Point3D(x2, y2, z3);
}

// ------------------- PROJECTIONS --------------------
function project(p) {
    let x = p.x, y = p.y, z = p.z;

    if (projection === "orthographic") {
        return {
            x: 400 + x * zoom,
            y: 300 - y * zoom
        };
    }

    if (projection === "perspective") {
        let d = 300;
        return {
            x: 400 + (x * d * zoom) / (z + d),
            y: 300 - (y * d * zoom) / (z + d)
        };
    }

    if (projection === "isometric") {
        let cos30 = 0.866, sin30 = 0.5;
        return {
            x: 400 + (x - y) * cos30 * zoom,
            y: 300 - ((x + y) * sin30 * zoom + z * zoom)
        };
    }
}

// ------------------- DRAW FUNCTIONS --------------------
function drawLine(p1, p2) {
    ctx.beginPath();
    ctx.moveTo(p1.x, p1.y);
    ctx.lineTo(p2.x, p2.y);
    ctx.strokeStyle = "white";
    ctx.stroke();
}

function drawBox(shape) {
    let s = shape.map(p => project(rotatePoint(p)));

    let edges = [
        [0,1],[1,2],[2,3],[3,0],
        [4,5],[5,6],[6,7],[7,4],
        [0,4],[1,5],[2,6],[3,7]
    ];

    for (let e of edges) {
        drawLine(s[e[0]], s[e[1]]);
    }
}

function drawPyramid(shape) {
    let s = shape.map(p => project(rotatePoint(p)));

    // base
    drawLine(s[0], s[1]);
    drawLine(s[1], s[2]);
    drawLine(s[2], s[3]);
    drawLine(s[3], s[0]);

    // sides
    for (let i = 0; i < 4; i++)
        drawLine(s[i], s[4]);
}

function drawSphere() {
    let r = 60;
    for (let phi = -90; phi <= 90; phi += 30) {
        let prev = null;
        for (let theta = 0; theta <= 360; theta += 10) {
            let x = r * Math.cos(phi * Math.PI/180) * Math.cos(theta * Math.PI/180);
            let y = r * Math.sin(phi * Math.PI/180);
            let z = r * Math.cos(phi * Math.PI/180) * Math.sin(theta * Math.PI/180);

            let pt = project(rotatePoint(new Point3D(x,y,z)));
            if (prev) drawLine(prev, pt);
            prev = pt;
        }
    }
}

// ------------------- SHAPES --------------------
let cube = [
    new Point3D(-50,-50,-50), new Point3D(50,-50,-50),
    new Point3D(50,50,-50),  new Point3D(-50,50,-50),
    new Point3D(-50,-50,50), new Point3D(50,-50,50),
    new Point3D(50,50,50),   new Point3D(-50,50,50)
];

let cuboid = [
    new Point3D(-70,-40,-30), new Point3D(70,-40,-30),
    new Point3D(70,40,-30),   new Point3D(-70,40,-30),
    new Point3D(-70,-40,30),  new Point3D(70,-40,30),
    new Point3D(70,40,30),    new Point3D(-70,40,30)
];

let pyramid = [
    new Point3D(-50,-50,50), new Point3D(50,-50,50),
    new Point3D(50,-50,-50), new Point3D(-50,-50,-50),
    new Point3D(0,50,0)
];

// ------------------- RENDER LOOP --------------------
function loop() {
    ctx.clearRect(0,0,800,600);

    if (multiMode) {
        drawBox(cube);
        drawPyramid(pyramid);
    } else {
        if (choice === 1) drawBox(cube);
        else if (choice === 2) drawBox(cuboid);
        else if (choice === 3) drawPyramid(pyramid);
        else if (choice === 4) drawSphere();
    }

    requestAnimationFrame(loop);
}
loop();

// ------------------- KEYBOARD --------------------
document.addEventListener("keydown", function(e) {
    switch(e.key) {
        case "ArrowUp": angleX -= 5; break;
        case "ArrowDown": angleX += 5; break;
        case "ArrowLeft": angleY -= 5; break;
        case "ArrowRight": angleY += 5; break;
        case "a": case "A": angleZ -= 5; break;
        case "d": case "D": angleZ += 5; break;
        case "+": zoom += 0.1; break;
        case "-": zoom -= 0.1; if (zoom < 0.1) zoom = 0.1; break;

        case "1": choice = 1; break;
        case "2": choice = 2; break;
        case "3": choice = 3; break;
        case "4": choice = 4; break;

        case "o": case "O": projection = "orthographic"; break;
        case "p": case "P": projection = "perspective"; break;
        case "i": case "I": projection = "isometric"; break;
        case "m": case "M": multiMode = !multiMode; break;
    }
});
</script>

</body>
</html>
